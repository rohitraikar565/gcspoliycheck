
import "tfplan-functions" as plan

# Allowed GCS STORAGE ACCESS
allGCSStorage = plan.find_resources("google_storage_bucket")
Access control = ["Uniform"]
required_acl = "private"

# Count violations
violations = length(violatingGCSSTORAGE["messages"])

# Main rule
main = rule {
  violations is 0
}
